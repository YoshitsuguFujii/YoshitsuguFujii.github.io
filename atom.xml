<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

    <title><![CDATA[なんとなく日々徒然と]]></title>
    <link href="http://yoshitsugufujii.github.io/atom.xml" rel="self"/>
    <link href="http://yoshitsugufujii.github.io/"/>
    <updated>2017-06-29T16:12:28+09:00</updated>
    <id>http://yoshitsugufujii.github.io/</id>
    <author>
        <name><![CDATA[Yoshitsugu Fujii]]></name>
        
    </author>
    <generator uri="http://octopress.org/">Octopress</generator>

    
    <entry>
        <title type="html"><![CDATA[S3からRailsを介して大きなファイルをストリーミングダウンロードさせる]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2017/06/29/large-s3-file-relay/"/>
        <updated>2017-06-29T15:25:15+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2017/06/29/large-s3-file-relay</id>
        <content type="html"><![CDATA[<h3>近況とか</h3>

<p>最近の藤井は月〜木は新橋の方面で働き金曜日は在宅で仕事させてもらっています。<br/>
言語は相変わらずRubyでFWはRubyOnRailsですね。<br/>
Firebase触ったり、WebRTCに触ったり、はじめてガチでHeroku使ったりしています。</p>

<p>自分が業界に入りたての頃はこういったサービスがなかったので1からどう作るかって感じでしたが、<br/>
最近はどうやってサービスを組み合わせて作るかって感じに変化したように思います。<br/>
サービスの学習コストの方が高めですかね。</p>

<p>Macbook Airの日本語キーボードから英字配列のhhkbに移行しました。<br/>
:が打ちにくくて最初文句ブーブーでしたが、慣れるとたしかに英字配列の方がやりやすい気がします。<br/>
職場と自宅で持ち運びがめんどくさかったので二台買いました。<br/>
hhkbの墨とtype-sです。<br/>
お金使いすぎで鼻血出そうです。</p>

<p>帰宅ランは続けていて調子いいときは10キロぐらい走ります。<br/>
だいたい7、8キロぐらいを目安に走っています。<br/>
江戸川沿い走るの最高に気持ちいいです。</p>

<!-- more -->


<p></p>

<h3>表題の件</h3>

<p>S3のファイルをRailsを中継してクライアントにストリーミングダウンロードする処理書きました。<br/>
Httparty使ってます。Httpartyでstreaming download楽ですねー。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">AttachmentController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Live</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">download</span>
</span><span class='line'>    <span class="n">attachment</span> <span class="o">=</span> <span class="no">Attachment</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="k">begin</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">[</span><span class="s2">&quot;Content-Type&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="n">attachment</span><span class="o">.</span><span class="n">content_type</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">[</span><span class="s2">&quot;Content-Length&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="n">attachment</span><span class="o">.</span><span class="n">file_size</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">[</span><span class="s2">&quot;Content-Disposition&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;attachment; filename=</span><span class="si">#{</span><span class="n">attachment</span><span class="o">.</span><span class="n">file_before_type_cast</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">[</span><span class="s2">&quot;Content-Transfer-Encoding&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;binary&quot;</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">[</span><span class="s2">&quot;Last-Modified&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="n">attachment</span><span class="o">.</span><span class="n">updated_at</span><span class="o">.</span><span class="n">ctime</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'>      <span class="no">HTTParty</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attachment</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="ss">stream_body</span><span class="p">:</span> <span class="kp">true</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">fragment</span><span class="o">|</span>
</span><span class='line'>        <span class="nb">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">write</span> <span class="n">fragment</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">rescue</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Live</span><span class="o">::</span><span class="no">ClientDisconnected</span>  <span class="c1"># キャンセルされた場合</span>
</span><span class='line'>      <span class="c1"># nop</span>
</span><span class='line'>    <span class="k">ensure</span>
</span><span class='line'>      <span class="n">response</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">close</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Puma使いましょう。webrickとかthinは対応していません。</p>

<p>config/environments/development.rbに以下の設定を追加。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">cache_classes</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">eager_load</span> <span class="o">=</span> <span class="kp">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>あとは<code>bundle exec rails s Puma</code>して試してみてください。</p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[postgres使っていてridgepoleで文字列から数値型への変換エラー]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2017/04/13/ridgepole-postgres-change-type-cast/"/>
        <updated>2017-04-13T11:19:54+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2017/04/13/ridgepole-postgres-change-type-cast</id>
        <content type="html"><![CDATA[<p>表題のことをやろうとしたらエラーがでた。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[ERROR] PG::DatatypeMismatch: ERROR:  column "count" cannot be cast automatically to type integer
</span><span class='line'>HINT:  You might need to specify "USING count::integer".</span></code></pre></td></tr></table></div></figure>


<p>Schemafileをこうすればいけました。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>create_table "products", force: :cascade do |t|
</span><span class='line'>  t.integer  'count',             using: 'count::integer'
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>

]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[Ransackのデフォルトオーダーを変える方法]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2017/04/11/ransack-default-order/"/>
        <updated>2017-04-11T18:26:06+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2017/04/11/ransack-default-order</id>
        <content type="html"><![CDATA[<p><a href="http://www.logiclogic.jp/">ロジックロジック</a>を辞めました。<br/>
そして意識低い系なのにフリーランスになりました。<br/>
頑張っていきます。そしてお仕事ください。ペロペロ(靴を舐める音)</p>

<p>ransackのsort_linkで昇順降順のデフォルトを変える方法です。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">=</span> <span class="n">sort_link</span><span class="p">(</span><span class="vi">@q</span><span class="p">,</span> <span class="ss">:created_at</span><span class="p">,</span> <span class="s1">&#39;作成日&#39;</span><span class="p">,</span> <span class="ss">default_order</span><span class="p">:</span> <span class="ss">:desc</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>最近は週２ぐらいで3キロ〜5キロぐらいの帰宅ランにはまっています。<br/>
わざわざ時間をとったりしなくていいのでオススメですよ。</p>

<p>これトレイルラン用ですが、体にピタと密着して走っても鞄がぶれないのでオススメです。<br/>
MacBook Airの13インチとちょっとしたものが入るので便利！<br/>
PCとお弁当と水筒と着替えをいれて走ってます。</p>

<p><a href="https://www.amazon.co.jp/%E3%82%B5%E3%83%AD%E3%83%A2%E3%83%B3-%E3%83%90%E3%83%83%E3%82%AF%E3%83%91%E3%83%83%E3%82%AF-TRAIL-L37998300-GRANNY/dp/B014EBRLQG/ref=as_li_ss_il?ie=UTF8&qid=1491903304&sr=8-1&keywords=salomon+trail+20&linkCode=li3&tag=gogosakura-22&linkId=3bf38265c9d616b2ab28731fe38d0e44" target="_blank"><img border="0" src="//ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=B014EBRLQG&Format=_SL250_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=gogosakura-22" ></a><img src="https://ir-jp.amazon-adsystem.com/e/ir?t=gogosakura-22&l=li3&o=9&a=B014EBRLQG" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></p>

<p><a href="http://amzn.to/2nzWzof">[サロモン] バックパック TRAIL 20</a></p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[強引にGoのメールでverpに対応する]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/08/24/golang-mail-with-verp/"/>
        <updated>2016-08-24T18:19:24+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/08/24/golang-mail-with-verp</id>
        <content type="html"><![CDATA[<p>Golangで<a href="http://www.postfix-jp.info/trans-2.2/jhtml/VERP_README.html">VERP</a>対応したくて色々と調べましたが<br/>
強引にやる方法しか思いつかなかったけどせっかく調べたので記録する。<br/>
ソースはこちらを参考にさせていただきました(感謝)<br/>
<a href="http://d.hatena.ne.jp/taknb2nch/20140213/1392277157">Golang Cafe #16 まとめ その2 smtpパッケージ</a></p>

<p>verpって単一の宛先のみでカンマ区切りだったりccだったりbccだったりは対応できないっぽいです。<br/>
送るなら1メール1ユーザにしないとダメ？</p>

<!-- more -->


<h2>postfix設定</h2>

<p>main.cf
/etc/postfix/main.cf</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>recipient_delimiter = +
</span><span class='line'>default_verp_delimiters = -=
</span><span class='line'>smtpd_authorized_verp_clients = $mynetworks</span></code></pre></td></tr></table></div></figure>


<p>以下sendMailはsmtp.SendMailと引数を一緒にしています。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func sendMail(addr string, auth smtp.Auth, from string, to []string, msg []byte) error {
</span><span class='line'>  var client *smtp.Client
</span><span class='line'>  var err error
</span><span class='line'>
</span><span class='line'>  if client, err = smtp.Dial(addr); err != nil {
</span><span class='line'>      fmt.Fprintf(os.Stderr, "Error: %v\n", err)
</span><span class='line'>      os.Exit(1)
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  defer client.Close()
</span><span class='line'>
</span><span class='line'>  if err = client.Hello("localhost"); err != nil {
</span><span class='line'>      fmt.Fprintf(os.Stderr, "Error: %v\n", err)
</span><span class='line'>      os.Exit(1)
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  if auth != nil {
</span><span class='line'>      if err = client.Auth(auth); err != nil {
</span><span class='line'>          fmt.Fprintf(os.Stderr, "Error: %v\n", err)
</span><span class='line'>          os.Exit(1)
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  for _, addr := range to {
</span><span class='line'>      if err = client.Reset(); err != nil {
</span><span class='line'>          fmt.Fprintf(os.Stderr, "Error: %v\n", err)
</span><span class='line'>          os.Exit(1)
</span><span class='line'>      }
</span><span class='line'>
</span><span class='line'>      if err = mail(client, from); err != nil {
</span><span class='line'>          fmt.Fprintf(os.Stderr, "Error: %v\n", err)
</span><span class='line'>          os.Exit(1)
</span><span class='line'>      }
</span><span class='line'>
</span><span class='line'>      if err = client.Rcpt(addr); err != nil {
</span><span class='line'>          fmt.Fprintf(os.Stderr, "Error: %v\n", err)
</span><span class='line'>          os.Exit(1)
</span><span class='line'>      }
</span><span class='line'>
</span><span class='line'>      var w io.WriteCloser
</span><span class='line'>
</span><span class='line'>      if w, err = client.Data(); err != nil {
</span><span class='line'>          fmt.Fprintf(os.Stderr, "Error: %v\n", err)
</span><span class='line'>          os.Exit(1)
</span><span class='line'>      }
</span><span class='line'>
</span><span class='line'>      if _, err = w.Write([]byte(msg)); err != nil {
</span><span class='line'>          fmt.Fprintf(os.Stderr, "Error: %v\n", err)
</span><span class='line'>          os.Exit(1)
</span><span class='line'>      }
</span><span class='line'>
</span><span class='line'>      w.Close()
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  if err = client.Quit(); err != nil {
</span><span class='line'>      fmt.Fprintf(os.Stderr, "Error: %v\n", err)
</span><span class='line'>      os.Exit(1)
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  return nil
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>func mail(c *smtp.Client, from string) error {
</span><span class='line'>  cmdStr := "MAIL FROM:&lt;%s&gt; XVERP"
</span><span class='line'>
</span><span class='line'>  // 8BITMIMEは考慮しない
</span><span class='line'>
</span><span class='line'>  _, _, err := cmd(c, 250, cmdStr, from)
</span><span class='line'>  return err
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>func cmd(c *smtp.Client, expectCode int, format string, args ...interface{}) (int, string, error) {
</span><span class='line'>  id, err := c.Text.Cmd(format, args...)
</span><span class='line'>  if err != nil {
</span><span class='line'>      return 0, "", err
</span><span class='line'>  }
</span><span class='line'>  c.Text.StartResponse(id)
</span><span class='line'>  defer c.Text.EndResponse(id)
</span><span class='line'>  code, msg, err := c.Text.ReadResponse(expectCode)
</span><span class='line'>  return code, msg, err
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>

]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[ルビィのぼうけんをいただきました。]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/05/18/hello-ruby/"/>
        <updated>2016-05-18T10:45:37+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/05/18/hello-ruby</id>
        <content type="html"><![CDATA[<p><a href="http://asia.slush.org/">Slush Asia</a>にいった会社の同僚から
<a  href="http://www.amazon.co.jp/gp/product/4798143499/ref=as_li_ss_tl?ie=UTF8&camp=247&creative=7399&creativeASIN=4798143499&linkCode=as2&tag=gogosakura-22">ルビィのぼうけん こんにちは!  プログラミング</a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=gogosakura-22&l=as2&o=9&a=4798143499" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
をいただきました。</p>

<!-- more -->


<p><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4798143499/gogosakura--22/ref=nosim/" rel="nofollow" >
  <img src="http://ecx.images-amazon.com/images/I/5160R6cyiuL._SS500_.jpg" style="border: none;" alt="ルビィのぼうけん こんにちは! プログラミング" />
</a></p>

<p>Linda Liukasさんの直筆サイン付き！</p>

<p><img src="http://yoshitsugufujii.github.io/images/blog/2016_05_18_2.jpg" alt="サイン" style="width: 80%;"></p>

<p>ルビィという女の子のお話と演習を通してプログラム的な思考を身につけようという内容になっています。
娘が適齢期になったら読み聞かせてあげようと思います。</p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[子猫を拾いました]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/05/17/meet-kitten/"/>
        <updated>2016-05-17T12:09:43+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/05/17/meet-kitten</id>
        <content type="html"><![CDATA[<p>犬を散歩していたら子猫を拾いました。</p>

<!-- more -->


<p>なんか鳴き声がするなーと探したら２匹の生き物が。<br/>
最初ネズミかと思いましたがよく見ると目も開いていない2匹の子猫。<br/>
茶色い一匹はすでに死んでいて黒い子猫がその茶色の一匹の上に上半身だけのっかってピーピー鳴いてました。</p>

<p>親猫くるかなと思って40分その場で待ったんですが現れず、犬を家において再度現場へ。<br/>
悩みましたが一匹亡くなっていたので家にお持ち帰り。<br/>
なくなっていた子猫は庭に埋めました。</p>

<p>ほぼ深夜だったこともあり、ミルクを買えるようなお店もあいていないため砂糖水や牛乳をあげたりしました。<br/>
家にミルクをあげるようなスポイトや針なし注射器があるわけではなく近所のコンビニにいってストローを購入して5センチぐらいの長さにカットしてストローをつかってあげました。</p>

<p>朝になって近所の動物病院にいき健康状態チェック。<br/>
普段犬がお世話になっており動物病院にいきました。<br/>
そして注射器型のフィーダーとミルクをGET。<br/>
お会計ははなんと値段は診察料とミルク代で700円弱。<br/>
非常に助かります。</p>

<p>その足でペットショップで哺乳瓶とミルク購入。</p>

<p><img src="http://yoshitsugufujii.github.io/images/blog/2016_5_17_1.jpg" alt="保護2日目" /></p>

<p>子猫はamazonの段ボールにいれて、そこにタオルも何枚もひいて寝かせます。<br/>
段ボールに蓋がついているのですが、餌をあげた後は蓋をしめると寝てくれるので蓋つきがいい感じです。<br/>
また保温には<a href="http://www.amazon.co.jp/gp/product/B002MZXXUU/ref=as_li_ss_tl?ie=UTF8&camp=247&creative=7399&creativeASIN=B002MZXXUU&linkCode=as2&tag=gogosakura-22">エネループカイロ</a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=gogosakura-22&l=as2&o=9&a=B002MZXXUU" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />が活躍してくれました。</p>

<p>子猫は38度に保温してあげるといいそうなのですが、この<a href="http://www.amazon.co.jp/gp/product/B002MZXXUU/ref=as_li_ss_tl?ie=UTF8&camp=247&creative=7399&creativeASIN=B002MZXXUU&linkCode=as2&tag=gogosakura-22">カイロ</a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=gogosakura-22&l=as2&o=9&a=B002MZXXUU" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />を弱で使用すると39度になります。これを段ボールにいれてあげると気持ちよさそうに寝てました。</p>

<p><img src="http://yoshitsugufujii.github.io/images/blog/2016_5_17_2.jpg" alt="保護3日目" /></p>

<p>現在はすくすくと成長しています。<br/>
今後の成長に期待です。</p>

<div style="text-align: center; margin:auto 0;">  
  <iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=gogosakura-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B002MZXXUU" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>
</div>




<div class="space-h20"></div>

]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[犬のシャンプーで消臭]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/05/16/dog-shampoo/"/>
        <updated>2016-05-16T16:20:05+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/05/16/dog-shampoo</id>
        <content type="html"><![CDATA[<p>犬がそそうをしてしまった場合<br/>
消臭スプレーなんかも売っていますが、</p>

<!-- more -->




<div class="space-h20"></div>


<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=gogosakura-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B000FQSHJK" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<p></p>

<div class="space-h20"></div>


<p>犬用のシャンプーを霧吹きに水で薄めて使うと匂いも取れるし犬にいいとブリーダーにオススメされました。<br/>
ちょっとした小技ですね。</p>

<p>うちの２頭のフレンチブルドッグはこちらのシャンプーを使ってます。<br/>
上の犬は皮膚炎がありますが、問題なく使えてます。</p>

<p><a  href="http://www.amazon.co.jp/gp/product/B00195AGYK/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=B00195AGYK&linkCode=as2&tag=gogosakura-22"><img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=B00195AGYK&Format=_SL250_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=gogosakura-22" ></a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=gogosakura-22&l=as2&o=9&a=B00195AGYK" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></p>

<p>リンスはこちら</p>

<p><a  href="http://www.amazon.co.jp/gp/product/B00195ALEA/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=B00195ALEA&linkCode=as2&tag=gogosakura-22"><img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=B00195ALEA&Format=_SL250_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=gogosakura-22" ></a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=gogosakura-22&l=as2&o=9&a=B00195ALEA" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></p>

<p>体にも使うシャンプーなら安心ですね！</p>

<div style="text-align: center; margin:auto 0;">  
  <img src="http://yoshitsugufujii.github.io/images/blog/2016_5_16.JPG" alt="小梅と小春" style="width: 80%;">
</div>


<p></p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[最近買って良かったもの]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/05/12/magnet-bookmarker/"/>
        <updated>2016-05-12T11:33:55+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/05/12/magnet-bookmarker</id>
        <content type="html"><![CDATA[<p>上野公園でかったマグネット型のブックマーカー。</p>

<p><a  href="http://www.amazon.co.jp/gp/product/B00H1L1AXW/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=B00H1L1AXW&linkCode=as2&tag=gogosakura-22"><img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=B00H1L1AXW&Format=_SL250_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=gogosakura-22" ></a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=gogosakura-22&l=as2&o=9&a=B00H1L1AXW" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></p>

<p>従来のしおりだとはさんだままだとしおりがページめくる時に邪魔になったり、<br/>
読んでいる最中しおりを手にもったままなのもわずらわしく、<br/>
大きめのカバンにいれてるとしおりが知らない間にはずれていたります。</p>

<!-- more -->


<p></p>

<p>このブックマーカーはマグネットでパチンとページを挟むことができ邪魔にならず、<br/>
はさなだままでもページを捲る時でも邪魔に感じません。</p>

<p>シンプルだけどとても使い勝手がよく重宝しております。</p>

<p>Amazonで見ると色々と売っているみたいですね。<br/>
かわいいのも多い。</p>

<p><a  href="http://www.amazon.co.jp/gp/product/B004K0PKBU/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=B004K0PKBU&linkCode=as2&tag=gogosakura-22"><img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=B004K0PKBU&Format=_SL250_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=gogosakura-22" ></a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=gogosakura-22&l=as2&o=9&a=B004K0PKBU" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></p>

<p><a target="_blank" href="http://www.amazon.co.jp/mn/search/ref=as_li_ss_tl?_encoding=UTF8&camp=247&creative=7399&field-keywords=%E3%83%9E%E3%82%B0%E3%83%8D%E3%83%83%E3%83%88%20%E3%83%96%E3%83%83%E3%82%AF%E3%83%9E%E3%83%BC%E3%82%AB%E3%83%BC&linkCode=ur2&rh=i%3Aaps%2Ck%3A%E3%83%9E%E3%82%B0%E3%83%8D%E3%83%83%E3%83%88%20%E3%83%96%E3%83%83%E3%82%AF%E3%83%9E%E3%83%BC%E3%82%AB%E3%83%BC&tag=gogosakura-22&url=search-alias%3Daps">Amazon</a><img src="https://ir-jp.amazon-adsystem.com/e/ir?t=gogosakura-22&l=ur2&o=9" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />でブックマーカーで検索するとたくさんでてくるようです。</p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[複数サーバーssh同時操作]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/05/11/tmux-concurrent-operation/"/>
        <updated>2016-05-11T12:12:31+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/05/11/tmux-concurrent-operation</id>
        <content type="html"><![CDATA[<p>冗長構成となっている本番環境でlogを調べたい時とかそれぞれのサーバーにsshしてはいってそれぞれのサーバーで同じコマンド打つのが面倒くさい。<br/>
tmuxを使っていれば複数ペインで同時操作できます。</p>

<!-- more -->


<p></p>

<p>.tmux.confに設定追加</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ペイン同時操作  
</span><span class='line'>set-option -g synchronize-panes off  
</span><span class='line'>bind e setw synchronize-panes on  
</span><span class='line'>bind E setw synchronize-panes off  </span></code></pre></td></tr></table></div></figure>


<p></p>

<p>これで</p>

<p>ペイン分割して一つ目のペインでサーバーAへ接続<br/>
二つ目のペインでサーバーBへ接続します。</p>

<p>そのあとCTRL + eでtmuxにコマンドを送るとキーボード入力が２つのペインに送られるようになるので<br/>
しかるべきlogフォルダまで移動してlogを見ればいいですね。<br/>
同期を解除したい場合はCTRL + Eで解除できます。</p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[Go言語でファイル送信用cuiツールを作ったよ]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/05/10/golang-file-exchange-tool/"/>
        <updated>2016-05-10T19:50:24+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/05/10/golang-file-exchange-tool</id>
        <content type="html"><![CDATA[<p>ファイルをやりとりする場合に、一旦共有サーバーにあげてとかメールに添付したりとかめんどくさくて作りました。 <br/>
Golangで作ったので異なるOSでも動きます(WinとMacで確認済み)</p>

<!-- more -->


<p></p>

<p>受信する側は引数なしで起動すると受信モードで待機します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>./file_exchange
</span></code></pre></td></tr></table></div></figure>


<p>もしくは winの場合はfile_exchange.exeをダブルクリックでもいけます</p>

<p>送信先の一覧は送信側で以下のコマンドをうつと受信待機中のipが取れるのでこれで取得しましょう</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>./file_exchange list
</span></code></pre></td></tr></table></div></figure>


<p>実行結果はこんな感じ。</p>

<p><img src="http://yoshitsugufujii.github.io/images/blog/2016-05-10.png" alt="リスト取得" /></p>

<p>udpでブロードキャストしているのですが、全部からリクエストもらってから終了のやり方がわからず<br/>
とりあえずタイムアウト3秒の間にレスポンスが返ってきたものが表示されます。<br/>
タイムアウトで処理を終了しているので例外で終わります。<br/>
どなたかうまいやり方知っている人がいれば教えて下さい。</p>

<p>ipを取得したら送信します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>./file_exchange ipアドレス ファイルパス<span class="sb">`</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>で送信できます。<br/>
こんな感じです。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>./file_exchange 192.168.134.34 avator.png
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>上書きが怖かったので同名のファイルがある場合はファイル名に_Nをつけて保存するようにしています。</p>

<p>今回winでも試してみましたが、winでも動いて感動しました 。</p>

<p>コードはこちらを参照してください。buidも各自でお願いします<br/>
<a href="https://github.com/YoshitsuguFujii/file_exchange">YoshitsuguFujii/file_exchange</a></p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[csvなどで多重配列を縦横を入れ替える(行列切り替え)]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/05/09/ruby-transpose/"/>
        <updated>2016-05-09T10:51:15+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/05/09/ruby-transpose</id>
        <content type="html"><![CDATA[<p>小ネタです。<br/>
Csvファイルなどで行列を切り替えて出力したい場合はtransposeが便利です。</p>

<!-- more -->


<p></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">csv</span><span class="o">.</span><span class="n">each</span><span class="p">{</span><span class="o">|</span><span class="n">row</span><span class="o">|</span> <span class="nb">p</span> <span class="n">row</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'><span class="n">csv</span> <span class="o">=</span> <span class="o">[[</span><span class="s2">&quot;user_name&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;gender&quot;</span><span class="o">]</span><span class="p">,</span> <span class="o">[</span><span class="s2">&quot;藤井&quot;</span><span class="p">,</span> <span class="s2">&quot;36&quot;</span><span class="p">,</span> <span class="s2">&quot;men&quot;</span><span class="o">]]</span>
</span><span class='line'><span class="n">csv</span><span class="o">.</span><span class="n">each</span><span class="p">{</span><span class="o">|</span><span class="n">row</span><span class="o">|</span> <span class="nb">p</span> <span class="n">row</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'><span class="c1"># =&gt; &quot;user_name,age,gender&quot;  </span>
</span><span class='line'><span class="c1"># =&gt; &quot;藤井,36,men&quot;  </span>
</span><span class='line'>
</span><span class='line'><span class="n">csv</span><span class="o">.</span><span class="n">transpose</span><span class="o">.</span><span class="n">each</span><span class="p">{</span><span class="o">|</span><span class="n">row</span><span class="o">|</span> <span class="nb">p</span> <span class="n">row</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'><span class="c1"># =&gt; &quot;user_name,藤井&quot;  </span>
</span><span class='line'><span class="c1"># =&gt; &quot;age,36&quot;  </span>
</span><span class='line'><span class="c1"># =&gt; &quot;gender,men&quot;  </span>
</span></code></pre></td></tr></table></div></figure>


<p></p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[船橋三番瀬で潮干狩り]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/05/06/funabashi-sanbanse/"/>
        <updated>2016-05-06T11:09:41+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/05/06/funabashi-sanbanse</id>
        <content type="html"><![CDATA[<p>昨日妻と娘と3人で<a href="http://www.park-funabashi.or.jp/bay/">ふなばし 三番瀬海浜公園</a>に潮干狩りにいってきました。<br/>
駐車場はまず諦めろと事前情報があったため自転車でいきました。<br/>
久しぶりの自転車遠出はあたたかくて気持ちよかったです。<br/>
GWということもあり駐車場は朝6時半には満車になっていたようですね。</p>

<!-- more -->


<p>三番瀬海浜公園に近づくにつれて路駐路駐路駐。<br/>
１キロ以上離れたところから路駐して歩いている人がいっぱいいました。</p>

<p>10時頃到着したのですが、チケット売り場は行列。</p>

<p>近所のコンビニで買うことをおすすめします。<br/>
通常料金430円が390円になるうえにチケット購入の列に並ばなくてすみます。</p>

<p>チケットを買って前に進むと潮干狩り会場の前に売店がいくつかあります。<br/>
おいしそうなものが売っていたりビールが売っていたり、潮干狩り用の道具も売っていたりします。<br/>
お値段はぼったくりではないレベルで好感が持てますが多少高めです。<br/>
熊手しか持っていなかったので子供用バケツ(300円)と網(200円)を購入。<br/>
<br / >
いざ入場。人の多さに呆気にとられます。   <br/>
<img src="http://yoshitsugufujii.github.io/images/blog/20160509_1.jpg" alt="フェスかと思った" /></p>

<div style="text-align: center; font-weight:bold;">  
なんかのフェスかと思った
</div>


<p>
<br /></p>

<div style="text-align: center;">  
  そして無心に掘り続けます
</div>


<p><br /></p>

<div style="text-align: center; margin:auto 0;">  
  <img src="http://yoshitsugufujii.github.io/images/blog/20160509_2.JPG" alt="無心に掘る" style="width: 80%;">
</div>


<p></p>

<div style="text-align: center;">  
  掘り続けます...
</div>


<p><br /></p>

<div style="text-align: center; margin:auto 0;">  
  <img src="http://yoshitsugufujii.github.io/images/blog/20160509_3.jpg" alt="遊ぶ娘" style="width: 80%;">
</div>


<p>
<br /></p>

<p>GWだからかアサリの他にハマグリもまかれていました。<br/>
でっかいのが見つかると嬉しいですね。<br/>
無心に掘り続けて見事2.6キロゲット(1時間ぐらい)<br/>
持ち帰りは100gで80円なので2080円でした。<br/>
<br /></p>

<p>終わり間近になると計量所が混みます。<br/>
計量は多く取りすぎた人が欲しい量に調節したりもできるので進みが悪く25メートルぐらいの行列でも1時間弱かかりました。<br/>
潮干狩りの入場した後に買える1キロの赤い網を購入すると計量しないでいいみたいです。<br/>
よくわからずに外の売店で網買ってしまいましたが、この潮干狩り会場でうっている1キロの網を買うのが賢いですね。</p>

<div style="text-align: center; margin:auto 0;">  
  <img src="http://yoshitsugufujii.github.io/images/blog/20160509_5.jpg" alt="砂抜き" style="width: 80%;">
</div>


<p>
<br /></p>

<p>帰って砂抜きして炊き込みご飯、酒蒸し、お吸い物にして食べました。<br/>
感動するほどうまかったです。</p>

<p>6月11日までやっているようなのでもう一度行きます。</p>

<h2>まとめ</h2>

<p><strong>金額</strong><br/>
入場料 430円 * 2(4歳未満の子供は無料)<br/>
2.6キロのはまぐり持ち狩り代金 2080円<br/>
合計2940円</p>

<p><strong>次行く時用意するリスト</strong><br/>
熊手(100均のは力が入りずらいけど十分使える)<br/>
網(貝をいれておく)<br/>
バケツ(海水をいれて貝をいれておく)<br/>
帽子<br/>
濡れてもいい服<br/>
ビーサンもしくは長靴<br/>
クーラーボックス(長時間持ち歩く場合)</p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[個人事業の始め方を読みました]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/05/02/kojin-jigyo/"/>
        <updated>2016-05-02T15:13:53+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/05/02/kojin-jigyo</id>
        <content type="html"><![CDATA[<p>随所に図解がはいりわかりやすく、<br/>
1ページのテキスト量も読むのつらいなと感じさせるほど多くなく<br/>
スイスイと読み進めることができました。</p>

<p>頭にすっとはいってきます。<br/>
感覚的には8時間ぐらいで読了したつもりです。</p>

<p>個人事業主としてではなく社会人としての教養として読んでおいても損はないなぁと思いました。</p>

<p>Amazonでkindleで買いました。</p>

<!-- more -->


<p><a  href="http://www.amazon.co.jp/gp/product/B00I8PIA2O/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=B00I8PIA2O&linkCode=as2&tag=gogosakura-22"><img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=B00I8PIA2O&Format=_SL250_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=gogosakura-22" ></a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=gogosakura-22&l=as2&o=9&a=B00I8PIA2O" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></p>

<p>副業で1週間5〜10時間ぐらいの機能をつくってお金もらえる生活に憧れる。</p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[Axlsxでコメント表示]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/04/29/axlsx-comment/"/>
        <updated>2016-04-29T14:50:47+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/04/29/axlsx-comment</id>
        <content type="html"><![CDATA[<p>Axlsxで常に表示されているコメントとマウスオーバーで表示されるコメント</p>

<p><img src="http://yoshitsugufujii.github.io/images/blog/2016-04-29%2014.53.19.png" alt="Axlsxコメント" /></p>

<!-- more -->




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;axlsx&#39;</span>
</span><span class='line'><span class="n">package</span> <span class="o">=</span> <span class="no">Axlsx</span><span class="o">::</span><span class="no">Package</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">package</span><span class="o">.</span><span class="n">use_shared_strings</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'><span class="n">sheet</span> <span class="o">=</span> <span class="n">package</span><span class="o">.</span><span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="nb">name</span><span class="p">:</span> <span class="s1">&#39;lists&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">sheet</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">[</span><span class="s1">&#39;品名&#39;</span><span class="p">,</span> <span class="s1">&#39;単価&#39;</span><span class="p">,</span> <span class="s1">&#39;数量&#39;</span><span class="p">,</span> <span class="s1">&#39;計&#39;</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="n">sheet</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">[</span><span class="s1">&#39;にんじん&#39;</span><span class="p">,</span>    <span class="mi">80</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>      <span class="s1">&#39;=B2*C2&#39;</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="n">sheet</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">[</span><span class="s1">&#39;たまねぎ&#39;</span><span class="p">,</span>    <span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>      <span class="s1">&#39;=B3*C3&#39;</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="n">sheet</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">[</span><span class="s1">&#39;じゃがいも&#39;</span><span class="p">,</span>  <span class="mi">40</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>      <span class="s1">&#39;=B4*C4&#39;</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="n">sheet</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">[</span><span class="s1">&#39;牛肉&#39;</span><span class="p">,</span>       <span class="mi">200</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>      <span class="s1">&#39;=B5*C5&#39;</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="n">sheet</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">[</span><span class="s1">&#39;カレー粉&#39;</span><span class="p">,</span>   <span class="mi">150</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>      <span class="s1">&#39;=B6*C6&#39;</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="n">sheet</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span>            <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;総計&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUM(D2:D6)&#39;</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#sheet.add_comment :ref =&gt; &#39;A1&#39;, :text =&gt; &#39;penut machine&#39;, :author =&gt; &#39;crank&#39;, :visible =&gt; true</span>
</span><span class='line'><span class="n">sheet</span><span class="o">.</span><span class="n">add_comment</span><span class="p">(</span><span class="ss">:ref</span> <span class="o">=&gt;</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="ss">:author</span> <span class="o">=&gt;</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="s1">&#39;Yes We Can!&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">comment</span><span class="o">|</span>
</span><span class='line'>  <span class="n">comment</span><span class="o">.</span><span class="n">vml_shape</span><span class="o">.</span><span class="n">top_row</span> <span class="o">=</span> <span class="mi">2</span>      <span class="c1"># 位置調整用</span>
</span><span class='line'>  <span class="n">comment</span><span class="o">.</span><span class="n">vml_shape</span><span class="o">.</span><span class="n">left_column</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># 位置調整用</span>
</span><span class='line'>  <span class="n">comment</span><span class="o">.</span><span class="n">vml_shape</span><span class="o">.</span><span class="n">bottom_row</span> <span class="o">=</span> <span class="mi">2</span>   <span class="c1"># 位置調整用</span>
</span><span class='line'>  <span class="n">comment</span><span class="o">.</span><span class="n">vml_shape</span><span class="o">.</span><span class="n">right_column</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># 位置調整用</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="n">sheet</span><span class="o">.</span><span class="n">add_comment</span> <span class="ss">:ref</span> <span class="o">=&gt;</span> <span class="s1">&#39;A6&#39;</span><span class="p">,</span> <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="s1">&#39;rust bucket&#39;</span><span class="p">,</span> <span class="ss">:author</span> <span class="o">=&gt;</span> <span class="s1">&#39;PO&#39;</span><span class="p">,</span> <span class="ss">:visible</span> <span class="o">=&gt;</span> <span class="kp">false</span>
</span><span class='line'>
</span><span class='line'><span class="n">package</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="s1">&#39;test.xlsx&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[あなたが損しなさいという文化]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/04/28/you-should-take-a-loss/"/>
        <updated>2016-04-28T11:24:54+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/04/28/you-should-take-a-loss</id>
        <content type="html"><![CDATA[<p>今日車を運転していたらこんな状況になりました。</p>

<p>|　　　　　　|<br/>
|　　　　　　|<br/>
|　　　　　&mdash;<br/>
|　　　　　|　<br/>
|　　　　　|　<br/>
|　対向車　|　<br/>
|　　　　　|　<br/>
|　　　　　|　<br/>
|　　　　　|　<br/>
|　自分車　|　<br/>
|　　　　　|　<br/>
|　　　　　&mdash;　<br/>
|　　　　　　|　<br/>
|　　　　　　|　</p>

<!-- more -->


<p>ちょうど道の狭いところでかちあってしまい、お互いバックすればすれ違うポイントがあるけれどという状況です。<br/>
こういう場合は日本人はどちらかが損しなければならない場合は、自分が損をするという道徳観を子供の頃からすりこまれている気がします。</p>

<p>民度の高さが話題にあがることがありますが、こういう道徳観というのは日本人を語る上での大事なファクターになるなぁと思いました。</p>

<p>ちなみに今日は上記状況になったあとお互いが同時にバックするという状況になりました。</p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[喉のリンパが腫れました]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/04/27/lymph-hareta/"/>
        <updated>2016-04-27T11:58:10+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/04/27/lymph-hareta</id>
        <content type="html"><![CDATA[<p>先週まで花粉症なのか喉がピリピリして咳もでて目が痒かったんですが、<br/>
今週入って症状がピタッと止まったかと思いきや喉の右側のリンパが腫れ出しました。<br/>
首に異物感がずっとあり鈍い痛みがあります。<br/>
左向いてつば飲み込むと突っ張ったような痛みがずきりと走ります。</p>

<!-- more -->


<p>思い出せば一昨年も腫れて去年も軽かったんですが腫れました。<br/>
そして同じ時期に腫れてます。</p>

<p>リンパが腫れた原因はひょっとして花粉症？<br/>
ということで病院に行きました。<br/>
アレルギーでリンパが腫れることはあるが滅多にないとのこと。</p>

<p>もし仮にアレルギーで腫れていた場合でも治療法はなく。<br/>
おさまるまで耐えるしかないとのことでした。</p>

<p>なのでリンパ節炎として処置しますとのことで抗生物質と炎症を抑える薬をもらいました。</p>

<p>うーむ。辛い</p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[model.changesで強制的に変更したことにする方法]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/04/11/rails-dirty-mark-changed/"/>
        <updated>2016-04-11T18:26:43+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/04/11/rails-dirty-mark-changed</id>
        <content type="html"><![CDATA[<p>RailsのActiveModelのDirtyでは変更前、変更後、変更したかなどモデルクラスの新旧状態が取れる。<br/>
<a href="http://qiita.com/kakkunpakkun/items/b286f789ca8590104ad1">http://qiita.com/kakkunpakkun/items/b286f789ca8590104ad1</a></p>

<p>このdirtyを使って変更してないけど変更したことにしたい(observerを再実行したい時とか)に使える技</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">first</span>
</span><span class='line'><span class="n">user</span><span class="o">.</span><span class="n">changes</span> <span class="c1"># =&gt; {}</span>
</span><span class='line'><span class="n">user</span><span class="o">.</span><span class="n">created_at_will_change!</span> <span class="c1"># =&gt; =&gt; 2015-01-16 20:09:59 +0900</span>
</span><span class='line'><span class="n">user</span><span class="o">.</span><span class="n">changes</span>
</span><span class='line'><span class="c1"># =&gt; {</span>
</span><span class='line'><span class="c1">#  &quot;created_at&quot; =&gt; [</span>
</span><span class='line'><span class="c1">#    [0] 2015-01-16 20:09:59 +0900,</span>
</span><span class='line'><span class="c1">#    [1] 2015-01-16 20:09:59 +0900</span>
</span><span class='line'><span class="c1">#   ]</span>
</span><span class='line'><span class="c1"># }</span>
</span></code></pre></td></tr></table></div></figure>


<p>属性名_will_change!で新旧に同じ値が設定される。</p>

<p>なんでこんなことやりたかったかっていうとobserverでuserのnameの値が変更されたらapiを叩く処理を書いていたのだけど、急遽全件apiを再実行する必要があり強制的にnameが変更されたことにしたかったため調べたらあったというお話</p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[[小ネタ]Railsを使っていてAngularのform validationだけしたい時]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/03/23/angular-with-rails-name-convention/"/>
        <updated>2016-03-23T12:36:53+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/03/23/angular-with-rails-name-convention</id>
        <content type="html"><![CDATA[<p>railsでシステムを作っていて、ここはゴリゴリ書くようなところじゃないけどformのvalidationだけangularの機能使いたくなったんですが。
railsはname属性に[]を使うので、この場合のng-show内部の指定がわからなかったので備忘録も兼ねて。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='erb'><span class='line'><span class="x">form name=&quot;new_form&quot;</span>
</span><span class='line'><span class="x">  input name=&quot;price[hoge]&quot; ng-model=&quot;price&quot; ng-pattern=&quot;/^([1-9]\\d*|0)(\\.\\d+)?$/&quot; required=&quot;&quot; type=&quot;text&quot; /</span>
</span><span class='line'><span class="x">  span.text-error ng-show=&quot;newForm[&#39;price[hoge]&#39;].$error.required&quot;  ※</span>
</span><span class='line'><span class="x">  span.text-error ng-show=&quot;newForm[&#39;price[hoge]&#39;].$error.pattern&quot;  This is not a valid dollar.</span>
</span></code></pre></td></tr></table></div></figure>


<p>formのnameに指定されいるものを[]とシングルクォートで囲むといけます。</p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[どうしようもないお客さんとやってく方法]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/03/18/stressful-working-tips-1/"/>
        <updated>2016-03-18T11:45:25+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/03/18/stressful-working-tips-1</id>
        <content type="html"><![CDATA[<p>どうしようもないお客さんというのはいるもんですが、<br/>
サラリーマンをやっているとどうしても対応せざるを得ないわけです。<br/>
そんなお客さんにこの度ちょっと効果的なやり方で対応できました。</p>

<p>久しぶりにはっきりいって本気で仕事したくなくなったお客さん登場です。<br/>
別でかかえていた案件もリリース直前でパツっていたこともあり、飛んでくるタスクをついつい放置してしまいそうです。</p>

<p>そこでどうしたら効果的にモチベーションを保ちつつ仕事を進められたかというと。</p>

<!-- more -->


<p>間に一人ディレクターに入ってもらいました。<br/>
すると今まで</p>

<p><strong>自分 → お客さん</strong></p>

<p>と直接お客さんのために動かなければいけない状態から</p>

<p><strong>自分 → ディレクター → お客さん</strong></p>

<p>となり、お客さんのために頑張るという構図が消え、<br/>
ディレクターに迷惑にならないようにディレクターのために頑張るという作用が生まれ<br/>
むしろタスクの消化が通常より早くなるという現象が起きました。</p>

<p>この時ディレクター役の人には迷惑をかけられないような実在する人を選ぶのがポイントです</p>

<ul>
<li>仲の良い人</li>
<li>同じ会社にいるけど全く交流のない人</li>
<li>目上の人</li>
<li>直属の部下</li>
<li>かわいい女性、もしくはかっこいい男性</li>
<li>出世競争におけるライバル</li>
</ul>


<p>などが該当するかと思います。</p>

<p>また間に入る人はただの伝言役なので特にスキルが求められるわけではなく、<br/>
それほど負担にはならないんじゃないかと思います。<br/>
まぁなんか責任問題になったら一緒に土下座する必要はありますが、</p>

<p>いかがでしょうか？<br/>
今後もだましだましやりながらこのストレス社会を乗り切っていきたいと思います。</p>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[Rails 便利なテクニック その１]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2016/02/18/rails-tips-1/"/>
        <updated>2016-02-18T11:33:58+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2016/02/18/rails-tips-1</id>
        <content type="html"><![CDATA[<p>日常コード書いてて便利だなぁと思った技とかを思い出したら不定期に書いていきます。</p>

<p>よくメニューをulとliを使ってタブで表示することがあると思います。<br/>
例えばタブは以下の条件で表示されます</p>

<ul>
<li>ユーザの年齢が20歳以上なら表示するタブA</li>
<li>ユーザの性別が男性なら表示するタブB</li>
<li>ユーザの性別が女性なら表示するタブC</li>
<li>ユーザの性別が男性でかつ20歳以上なら表示するタブD</li>
</ul>


<p>実装が終わって総合テストがはじまります。</p>

<p>ここでチケットがあがってきます。</p>

<p><strong>『タブが一つしか出力されない場合はタブを非表示にしてください。』</strong></p>

<p>さてどうしましょう？</p>

<!-- more -->


<p>複雑なif文を組み合わせてタブが１つかでない条件を見つけ出して非表示にしますか？<br/>
タブが増えたり条件が増えたりしたら大変な上に可読性悪そうですね。</p>

<p>Railsには便利なcaptureというメソッドがあります。<br/>
これはcaptureメソッドに与えられたブロックの出力内容を返すメソッドです。<br/>
これを使うとシンプルに問題を解決できます。</p>

<figure class='code'><figcaption><span>app/views/layout/tab.html.erb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='erb'><span class='line'><span class="cp">&lt;%</span> <span class="n">tab</span> <span class="o">=</span> <span class="n">capture</span> <span class="k">do</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">  &lt;ul&gt;</span>
</span><span class='line'><span class="x">    </span><span class="cp">&lt;%</span> <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">20</span> <span class="cp">%&gt;</span><span class="x"> </span>
</span><span class='line'><span class="x">      &lt;li&gt;タブA&lt;/li&gt;</span>
</span><span class='line'><span class="x">    </span><span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'>
</span><span class='line'><span class="x">    </span><span class="cp">&lt;%</span> <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">male?</span> <span class="cp">%&gt;</span><span class="x"> </span>
</span><span class='line'><span class="x">      &lt;li&gt;タブB&lt;/li&gt;</span>
</span><span class='line'><span class="x">    </span><span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'>
</span><span class='line'><span class="x">    </span><span class="cp">&lt;%</span> <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">female?</span> <span class="cp">%&gt;</span><span class="x"> </span>
</span><span class='line'><span class="x">      &lt;li&gt;タブC&lt;/li&gt;</span>
</span><span class='line'><span class="x">    </span><span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'>
</span><span class='line'><span class="x">    </span><span class="cp">&lt;%</span> <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">male?</span> <span class="o">&amp;&amp;</span> <span class="n">user</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">20</span> <span class="cp">%&gt;</span><span class="x"> </span>
</span><span class='line'><span class="x">      &lt;li&gt;タブD&lt;/li&gt;</span>
</span><span class='line'><span class="x">    </span><span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">  &lt;/ul&gt;</span>
</span><span class='line'><span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'>
</span><span class='line'><span class="cp">&lt;%</span> <span class="c1"># tabが一個ならば表示しない </span><span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="cp">&lt;%=</span> <span class="n">tab</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="s2">&quot;&lt;/li&gt;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">?</span> <span class="n">tab</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span> <span class="cp">%&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<p>htmlを動的に組み立てる際にあれこれするよりも、出力されたhtmlをもとに処理するというケースの方が圧倒的にスマートなケースがあるので積極的に使っていきたいですね。</p>
]]></content>
    </entry>
    
</feed>
