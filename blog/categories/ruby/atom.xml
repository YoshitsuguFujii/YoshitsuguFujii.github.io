<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

    <title><![CDATA[Category: ruby | なんとなく日々徒然と]]></title>
    <link href="http://yoshitsugufujii.github.io/blog/categories/ruby/atom.xml" rel="self"/>
    <link href="http://yoshitsugufujii.github.io/"/>
    <updated>2015-03-10T13:54:00+09:00</updated>
    <id>http://yoshitsugufujii.github.io/</id>
    <author>
        <name><![CDATA[Yoshitsugu Fujii]]></name>
        
      </author>
    <generator uri="http://octopress.org/">Octopress</generator>

    
    <entry>
        <title type="html"><![CDATA[Axlsxでエクセルのセルを折り返して全体を表示]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2015/02/24/20150224142535/"/>
        <updated>2015-02-24T14:25:12+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2015/02/24/20150224142535</id>
        <content type="html"><![CDATA[<pre><code class="ruby">require 'axlsx'

package = Axlsx::Package.new
sheet = package.workbook.add_worksheet(name: 'lists')

wrap_text = sheet.styles.add_style(
                              {
                               :fg_color=&gt; "FFFFFF",                           # 文字色
                               :b =&gt; true,                                     # 太字
                               :bg_color =&gt; "004586",                          # 背景色
                               :sz =&gt; 12,                                      # フォントサイズ
                               :border =&gt; { :style =&gt; :thin, :color =&gt; "00" }, # 罫線
                               :alignment =&gt; { :horizontal =&gt; :center,         # 配置
                                               :vertical =&gt; :center ,
                                               :wrap_text =&gt; true}
                              }
                            )

sheet.add_row(['とっても長いテキスト', '短いテキスト'], style: wrap_text)

sheet.column_info.first.width = 5
package.serialize('test.xlsx')
</code></pre>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[Axlsxでウィンドウ枠の固定]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2015/02/23/20150223110642/"/>
        <updated>2015-02-23T11:06:00+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2015/02/23/20150223110642</id>
        <content type="html"><![CDATA[<p>エクセルのウィンドウ枠の固定をAxlsxで行う方法</p>

<pre><code class="ruby">require 'axlsx'

package = Axlsx::Package.new
sheet = package.workbook.add_worksheet(name: 'lists')

sheet.add_row(['品名', '単価', '数量', '計'] )
sheet.add_row(['にんじん',    80, 1,      '=B2*C2'])

sheet.sheet_view.pane do |pane|
  pane.top_left_cell = "B2"
  pane.state = :frozen_split
  pane.y_split = 1
  pane.x_split = 1
  pane.active_pane = :bottom_right
end

package.serialize('test.xlsx')
</code></pre>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[Axlsxでエクセルファイル作成時に注意する点とかはまりどころとか]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2015/02/21/20150221171638/"/>
        <updated>2015-02-21T17:16:00+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2015/02/21/20150221171638</id>
        <content type="html"><![CDATA[<p>最近Railsを使う会社が増えてきて、2年前にRailsを扱う会社をエージェントに探してもらった時はなかなか見つからなかったんですが、今は楽に見つかりそうですね。
そもそも登録した転職サイトがダメだったのかもしれないと思いますが。
千葉でRuby、Railsメインでやってる会社ないかな。</p>

<p>さてさて、ここのところずっと触っているAxlsxです。</p>

<h3>型に気をつける</h3>

<p>エクセルのセルが数値か文字列かで挙動が変わったりします。
文字列型のカラムに&#8221;1000&#8221;とか入っていた場合、エクセルでは数値として認識されてしまってvloolupなどの関数が反応しないことがあります。
その場合は明示的にtypeを指定しましょう。</p>

<pre><code class="ruby">sheet.add_row(
  [
    "1000",
    1000,
  ], types: [:string, :float])
)

# もしくは
sheet.rows[0].cells[0].type = [:string]
</code></pre>

<p>typesに設定できるシンボル
<a href="http://www.rubydoc.info/github/randym/axlsx/master/Axlsx/Cell:type">Method: Axlsx::Cell  #type — Documentation for randym/axlsx
(master)</a>
[:date, :time, :float, :integer, :string, :boolean]</p>

<h3>エクセルの関数を設定してダウンロード</h3>

<p>そのままアップロードすると関数による値の設定が行われません。
おそらく数式はエクセルを開いた時にエクセル側で計算されるので、エクセルを一回も開かずにアップロードすると値が設定されていないことになるのかと思います
fomula  _valueを設定しましょう</p>

<pre><code class="ruby">sheet.add_row [1, 2, '=A1+B1'], :formula_values =&gt; [nil, nil, 3]

#_もしくは
sheet.rows[0].cells[0].value         = "=A1+B1"
sheet.rows[0].cells[0].formula_value = "3"
</code></pre>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[trueとfalseにrefinmentsを使ってメソッド追加]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2015/02/17/20150217112514/"/>
        <updated>2015-02-17T11:25:00+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2015/02/17/20150217112514</id>
        <content type="html"><![CDATA[<p>Rubyでモデルの値がtrueの場合は○。falseの場合は空文字を表示するメソッドが欲しかったのでrefimentsを使って実装したかったけどなかなかうまくいかない。<br/>
trueはインスタンスだと思うんだけど何か普通のインスタンスと違うのだろうか。</p>

<p>試行錯誤は省いて結論としてはこうしたらできました.</p>

<pre><code class="ruby">module BooleanEx
  refine TrueClass do
    def true.to_circle
      "○"
    end
  end

  refine FalseClass do
    def false.to_circle
      ""
    end
  end
end

using BooleanEx

true.to_circle # =&gt; "○"
false.to_circle # =&gt; ""
</code></pre>
]]></content>
    </entry>
    
    <entry>
        <title type="html"><![CDATA[カリー化のお話]]></title>
        <link href="http://yoshitsugufujii.github.io/blog/2014/12/19/20141219102458/"/>
        <updated>2014-12-19T10:24:00+09:00</updated>
        <id>http://yoshitsugufujii.github.io/blog/2014/12/19/20141219102458</id>
        <content type="html"><![CDATA[<p><a href="http://qiita.com/lnznt/items/0b20440cecd6f4e348b9">Ruby のカリー化を日本語で説明してみる -
Qiita</a><br/>
という記事を見たので自分も食べられない方のカリーを使ったものをなんか書いてみました。</p>

<p>irbで実行できます。</p>

<pre><code class="ruby">meeting = Proc.new do |teacher, student|
 p "#{teacher}は#{student}くんとカレーについて話す"
end

fujii_meeting = meeting.curry.("藤井先生")

%w(田中 佐藤 斉藤 加藤).each(&amp;fujii_meeting)
# =&gt; "藤井先生は田中くんとカレーについて話す"
# =&gt; "藤井先生は佐藤くんとカレーについて話す"
# =&gt; "藤井先生は斉藤くんとカレーについて話す"
# =&gt; "藤井先生は加藤くんとカレーについて話す"
</code></pre>
]]></content>
    </entry>
    
</feed>
